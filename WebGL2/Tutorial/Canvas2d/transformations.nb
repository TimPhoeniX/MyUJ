(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43754,       1172]
NotebookOptionsPosition[     41312,       1087]
NotebookOutlinePosition[     41672,       1103]
CellTagsIndexPosition[     41629,       1100]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.654333924322768*^9, 3.6543339491774673`*^9}}],

Cell[BoxData["\<\"/Users/pbialas/Dydaktyka/2015_16/\
3DGraphicsProgrammingTutorials/Canvas2d\"\>"], "Output",
 CellChangeTimes->{3.654333949514336*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"l", "=", "120"}], "\[IndentingNewLine]", 
 RowBox[{"w", "=", "20"}], "\[IndentingNewLine]", 
 RowBox[{"width", "=", "400"}], "\[IndentingNewLine]", 
 RowBox[{"height", "=", "200"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6537915281524076`*^9, 3.653791572665251*^9}, {
  3.653791637277459*^9, 3.653791647942316*^9}, {3.653792125233939*^9, 
  3.653792127156603*^9}}],

Cell[BoxData["120"], "Output",
 CellChangeTimes->{
  3.653791573750404*^9, {3.653791641147092*^9, 3.653791648786375*^9}, 
   3.65379212800128*^9, 3.653798205694528*^9, 3.6539767502083197`*^9, 
   3.654321759559683*^9}],

Cell[BoxData["20"], "Output",
 CellChangeTimes->{
  3.653791573750404*^9, {3.653791641147092*^9, 3.653791648786375*^9}, 
   3.65379212800128*^9, 3.653798205694528*^9, 3.6539767502083197`*^9, 
   3.654321759564391*^9}],

Cell[BoxData["400"], "Output",
 CellChangeTimes->{
  3.653791573750404*^9, {3.653791641147092*^9, 3.653791648786375*^9}, 
   3.65379212800128*^9, 3.653798205694528*^9, 3.6539767502083197`*^9, 
   3.654321759567842*^9}],

Cell[BoxData["200"], "Output",
 CellChangeTimes->{
  3.653791573750404*^9, {3.653791641147092*^9, 3.653791648786375*^9}, 
   3.65379212800128*^9, 3.653798205694528*^9, 3.6539767502083197`*^9, 
   3.654321759571251*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wagon", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
    RowBox[{"FaceForm", "[", 
     InterpretationBox[
      ButtonBox[
       TooltipBox[
        GraphicsBox[{
          {GrayLevel[0], RectangleBox[{0, 0}]}, 
          {GrayLevel[0], RectangleBox[{1, -1}]}, 
          {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
         AspectRatio->1,
         Frame->True,
         FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
         FrameTicks->None,
         ImageSize->
          Dynamic[{
           Automatic, 
            1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
             Magnification])}],
         PlotRangePadding->None],
        "RGBColor[1, 0, 0]"],
       Appearance->None,
       BaseStyle->{},
       BaselinePosition->Baseline,
       ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
         If[
          Not[
           AbsoluteCurrentValue["Deployed"]], 
          SelectionMove[Typeset`box$, All, Expression]; 
          FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
          FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
          FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
          MathLink`CallFrontEnd[
            FrontEnd`AttachCell[Typeset`box$, 
             FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
             Left, Top}, 
             "ClosingActions" -> {
              "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
       DefaultBaseStyle->{},
       Evaluator->Automatic,
       Method->"Preemptive"],
      RGBColor[1, 0, 0],
      Editable->False,
      Selectable->False], "]"}], ",", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "w"}], "/", "2"}], ",", 
         RowBox[{"w", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"l", "+", 
          RowBox[{"w", "/", "2"}]}], ",", 
         RowBox[{"w", "/", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
    RowBox[{"EdgeForm", "[", "Red", "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "w"}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.653791873751539*^9, 3.6537919093360443`*^9}, {
  3.65379195657787*^9, 3.6537920045268507`*^9}, {3.65379204922615*^9, 
  3.653792114816244*^9}, {3.65379500650714*^9, 3.653795006833091*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"EdgeForm", "[", 
    InterpretationBox[
     ButtonBox[
      TooltipBox[
       GraphicsBox[{
         {GrayLevel[0], RectangleBox[{0, 0}]}, 
         {GrayLevel[0], RectangleBox[{1, -1}]}, 
         {GrayLevel[0], RectangleBox[{0, -1}, {2, 1}]}},
        AspectRatio->1,
        Frame->True,
        FrameStyle->GrayLevel[0.],
        FrameTicks->None,
        ImageSize->
         Dynamic[{
          Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification]}],
        PlotRangePadding->None],
       "GrayLevel[0]"],
      Appearance->None,
      BaseStyle->{},
      BaselinePosition->Baseline,
      ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
        If[
         Not[
          AbsoluteCurrentValue["Deployed"]], 
         SelectionMove[Typeset`box$, All, Expression]; 
         FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
         FrontEnd`Private`$ColorSelectorInitialColor = GrayLevel[0]; 
         FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
         MathLink`CallFrontEnd[
           FrontEnd`AttachCell[Typeset`box$, 
            FrontEndResource["GrayLevelColorValueSelector"], {
            0, {Left, Bottom}}, {Left, Top}, 
            "ClosingActions" -> {
             "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
      DefaultBaseStyle->{},
      Evaluator->Automatic,
      Method->"Preemptive"],
     GrayLevel[0],
     Editable->False,
     Selectable->False], "]"}], ",", 
   RowBox[{"FaceForm", "[", 
    InterpretationBox[
     ButtonBox[
      TooltipBox[
       GraphicsBox[{
         {GrayLevel[0], RectangleBox[{0, 0}]}, 
         {GrayLevel[0], RectangleBox[{1, -1}]}, 
         {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
        AspectRatio->1,
        Frame->True,
        FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
        FrameTicks->None,
        ImageSize->
         Dynamic[{
          Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification]}],
        PlotRangePadding->None],
       "RGBColor[1, 0, 0]"],
      Appearance->None,
      BaseStyle->{},
      BaselinePosition->Baseline,
      ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
        If[
         Not[
          AbsoluteCurrentValue["Deployed"]], 
         SelectionMove[Typeset`box$, All, Expression]; 
         FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
         FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
         FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
         MathLink`CallFrontEnd[
           FrontEnd`AttachCell[Typeset`box$, 
            FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
            Left, Top}, 
            "ClosingActions" -> {
             "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
      DefaultBaseStyle->{},
      Evaluator->Automatic,
      Method->"Preemptive"],
     RGBColor[1, 0, 0],
     Editable->False,
     Selectable->False], "]"}], ",", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"130", ",", "10"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"EdgeForm", "[", 
    InterpretationBox[
     ButtonBox[
      TooltipBox[
       GraphicsBox[{
         {GrayLevel[0], RectangleBox[{0, 0}]}, 
         {GrayLevel[0], RectangleBox[{1, -1}]}, 
         {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
        AspectRatio->1,
        Frame->True,
        FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
        FrameTicks->None,
        ImageSize->
         Dynamic[{
          Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification]}],
        PlotRangePadding->None],
       "RGBColor[1, 0, 0]"],
      Appearance->None,
      BaseStyle->{},
      BaselinePosition->Baseline,
      ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
        If[
         Not[
          AbsoluteCurrentValue["Deployed"]], 
         SelectionMove[Typeset`box$, All, Expression]; 
         FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
         FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
         FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
         MathLink`CallFrontEnd[
           FrontEnd`AttachCell[Typeset`box$, 
            FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
            Left, Top}, 
            "ClosingActions" -> {
             "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
      DefaultBaseStyle->{},
      Evaluator->Automatic,
      Method->"Preemptive"],
     RGBColor[1, 0, 0],
     Editable->False,
     Selectable->False], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"120", ",", "20"}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.65379198676166*^9, 3.653792006378435*^9}, {
   3.653792052816486*^9, 3.653792129391588*^9}, {3.653795008400017*^9, 
   3.653795017696465*^9}, 3.653798027113207*^9, 3.653798206803782*^9, 
   3.653976750322241*^9, 3.6543217596805153`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FaceForm", "[", "]"}], ",", " ", 
     RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"width", ",", "height"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "wagon"}], "\[IndentingNewLine]", "}"}], "//", 
   RowBox[{
    RowBox[{"Scale", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.653791363385795*^9, 3.6537915308697643`*^9}, {
  3.653791577559433*^9, 3.6537916231918173`*^9}, {3.653791695881077*^9, 
  3.653791722601906*^9}, {3.653791764858482*^9, 3.653791766601194*^9}, {
  3.653792190149366*^9, 3.6537921915997458`*^9}}],

Cell[BoxData[
 GraphicsBox[GeometricTransformationBox[
   {EdgeForm[GrayLevel[0]], FaceForm[None], 
    RectangleBox[{0, 0}, {400, 200}], 
    {EdgeForm[GrayLevel[0]], FaceForm[RGBColor[1, 0, 0]], 
     LineBox[{{-10, 10}, {130, 10}}], 
     {EdgeForm[RGBColor[1, 0, 0]], RectangleBox[{0, 0}, {120, 20}]}}}, {{{1, 
    0}, {0, -1}}, Center}]]], "Output",
 CellChangeTimes->{{3.65379141931805*^9, 3.653791432215526*^9}, 
   3.653791605609861*^9, {3.6537916437751303`*^9, 3.6537916509139557`*^9}, 
   3.653791723508182*^9, {3.653791767766239*^9, 3.6537917748227987`*^9}, {
   3.653791992819377*^9, 3.653792012722211*^9}, {3.653792054100539*^9, 
   3.653792072082774*^9}, {3.653792103753996*^9, 3.6537921305664997`*^9}, 
   3.653795018651667*^9, 3.653798207651618*^9, 3.653976750340086*^9, 
   3.654321759711102*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.653791665882391*^9, 3.653791671827662*^9}, {
  3.653792216816865*^9, 3.653792218161875*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.653792221565213*^9, 3.653792239188978*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "do", "]"}]], "Input",
 CellChangeTimes->{{3.653794193472925*^9, 3.6537941972697287`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"compose", "[", 
   RowBox[{"f_", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"g", "[", "#", "]"}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.653792705900176*^9, 3.6537927332992563`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rotate", "[", "angle_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Rotate", "[", 
    RowBox[{"#", ",", "angle", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.653793872282037*^9, 3.6537938949120398`*^9}, {
   3.653794954383018*^9, 3.6537949689074707`*^9}, 3.654333465418035*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"translate", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Translate", "[", 
     RowBox[{"#", ",", "v"}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6537938975971403`*^9, 3.653793917514543*^9}, 
   3.6543328806855993`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"flip", "[", "]"}], ":=", 
  RowBox[{
   RowBox[{"Scale", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.654332887601623*^9, 3.654332917360929*^9}, {
  3.654333417828416*^9, 3.6543334195375547`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"do", "[", 
   RowBox[{"ops_", ",", "currentTransform_", ",", " ", "rest_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "op", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ops", "]"}], "\[Equal]", "0"}], ",", " ", 
       RowBox[{"Return", "[", "currentTransform", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"op", "=", 
      RowBox[{"First", "[", "ops", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{
         RowBox[{"Head", "[", "op", "]"}], "\[Equal]", "draw"}], "]"}], " ", 
       ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"currentTransform", ",", 
          RowBox[{"First", "[", "op", "]"}], ",", 
          RowBox[{"Rest", "[", "ops", "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"do", "[", 
         RowBox[{
          RowBox[{"Rest", "[", "ops", "]"}], ",", 
          RowBox[{"compose", "[", 
           RowBox[{"currentTransform", ",", "op"}], "]"}], ",", 
          RowBox[{"Rest", "[", "ops", "]"}]}], "]"}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6537928581869183`*^9, 3.6537928797252617`*^9}, {
  3.653792980089878*^9, 3.6537933528413267`*^9}, {3.6537934361634207`*^9, 
  3.6537934406739492`*^9}, {3.653793501686058*^9, 3.653793574914998*^9}, {
  3.6537937798656693`*^9, 3.653793841371438*^9}, {3.653794057494487*^9, 
  3.653794060171865*^9}, {3.653794153359577*^9, 3.653794182196425*^9}, {
  3.653794255715873*^9, 3.653794284978866*^9}, {3.653797102079337*^9, 
  3.653797106904254*^9}, {3.653797330250197*^9, 3.653797340049142*^9}, {
  3.65379745455652*^9, 3.653797455050768*^9}, {3.653797577816077*^9, 
  3.6537975802573433`*^9}, {3.653797624664318*^9, 3.653797653317915*^9}, {
  3.6537977392499037`*^9, 3.6537977492518997`*^9}, {3.653797937776476*^9, 
  3.6537979409030943`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"do", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rotate", "[", "0", "]"}], ",", 
      RowBox[{"draw", "[", "wagon", "]"}]}], "}"}], ",", "Identity", ",", 
    RowBox[{"{", "}"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.653793229873096*^9, 3.653793248627819*^9}, {
   3.653793378953599*^9, 3.653793409971006*^9}, {3.653793479206759*^9, 
   3.6537935147356358`*^9}, {3.653793594479946*^9, 3.65379369869427*^9}, {
   3.653793820827702*^9, 3.6537938250578623`*^9}, {3.653793936044713*^9, 
   3.653793949916827*^9}, {3.6537942125932302`*^9, 3.65379422512547*^9}, {
   3.653794288859439*^9, 3.653794322487041*^9}, {3.653794442001163*^9, 
   3.6537944494153*^9}, 3.653797159995206*^9, 3.6537973446386833`*^9, {
   3.653797494922277*^9, 3.653797535412809*^9}, {3.653797600238146*^9, 
   3.6537976124226017`*^9}, {3.653797716343346*^9, 3.653797728246323*^9}, {
   3.653797979797841*^9, 3.653797990867155*^9}, {3.653798165620131*^9, 
   3.6537981658228683`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Identity", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RotationBox["#1",
         BoxRotation->0.,
         BoxRotationPoint->{0, 0}], "&"}], ")"}], "[", "#1", "]"}], "]"}], 
    "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"EdgeForm", "[", 
      InterpretationBox[
       ButtonBox[
        TooltipBox[
         GraphicsBox[{
           {GrayLevel[0], RectangleBox[{0, 0}]}, 
           {GrayLevel[0], RectangleBox[{1, -1}]}, 
           {GrayLevel[0], RectangleBox[{0, -1}, {2, 1}]}},
          AspectRatio->1,
          Frame->True,
          FrameStyle->GrayLevel[0.],
          FrameTicks->None,
          
          ImageSize->
           Dynamic[{
            Automatic, 1.35 CurrentValue["FontCapHeight"]/
             AbsoluteCurrentValue[Magnification]}],
          PlotRangePadding->None],
         "GrayLevel[0]"],
        Appearance->None,
        BaseStyle->{},
        BaselinePosition->Baseline,
        ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
          If[
           Not[
            AbsoluteCurrentValue["Deployed"]], 
           SelectionMove[Typeset`box$, All, Expression]; 
           FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
           FrontEnd`Private`$ColorSelectorInitialColor = GrayLevel[0]; 
           FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
           MathLink`CallFrontEnd[
             FrontEnd`AttachCell[Typeset`box$, 
              FrontEndResource["GrayLevelColorValueSelector"], {
              0, {Left, Bottom}}, {Left, Top}, 
              "ClosingActions" -> {
               "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
        DefaultBaseStyle->{},
        Evaluator->Automatic,
        Method->"Preemptive"],
       GrayLevel[0],
       Editable->False,
       Selectable->False], "]"}], ",", 
     RowBox[{"FaceForm", "[", 
      InterpretationBox[
       ButtonBox[
        TooltipBox[
         GraphicsBox[{
           {GrayLevel[0], RectangleBox[{0, 0}]}, 
           {GrayLevel[0], RectangleBox[{1, -1}]}, 
           {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
          AspectRatio->1,
          Frame->True,
          FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
          FrameTicks->None,
          
          ImageSize->
           Dynamic[{
            Automatic, 1.35 CurrentValue["FontCapHeight"]/
             AbsoluteCurrentValue[Magnification]}],
          PlotRangePadding->None],
         "RGBColor[1, 0, 0]"],
        Appearance->None,
        BaseStyle->{},
        BaselinePosition->Baseline,
        ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
          If[
           Not[
            AbsoluteCurrentValue["Deployed"]], 
           SelectionMove[Typeset`box$, All, Expression]; 
           FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
           FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
           FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
           MathLink`CallFrontEnd[
             FrontEnd`AttachCell[Typeset`box$, 
              FrontEndResource["RGBColorValueSelector"], {
              0, {Left, Bottom}}, {Left, Top}, 
              "ClosingActions" -> {
               "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
        DefaultBaseStyle->{},
        Evaluator->Automatic,
        Method->"Preemptive"],
       RGBColor[1, 0, 0],
       Editable->False,
       Selectable->False], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"130", ",", "10"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"EdgeForm", "[", 
      InterpretationBox[
       ButtonBox[
        TooltipBox[
         GraphicsBox[{
           {GrayLevel[0], RectangleBox[{0, 0}]}, 
           {GrayLevel[0], RectangleBox[{1, -1}]}, 
           {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
          AspectRatio->1,
          Frame->True,
          FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
          FrameTicks->None,
          
          ImageSize->
           Dynamic[{
            Automatic, 1.35 CurrentValue["FontCapHeight"]/
             AbsoluteCurrentValue[Magnification]}],
          PlotRangePadding->None],
         "RGBColor[1, 0, 0]"],
        Appearance->None,
        BaseStyle->{},
        BaselinePosition->Baseline,
        ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
          If[
           Not[
            AbsoluteCurrentValue["Deployed"]], 
           SelectionMove[Typeset`box$, All, Expression]; 
           FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
           FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
           FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
           MathLink`CallFrontEnd[
             FrontEnd`AttachCell[Typeset`box$, 
              FrontEndResource["RGBColorValueSelector"], {
              0, {Left, Bottom}}, {Left, Top}, 
              "ClosingActions" -> {
               "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
        DefaultBaseStyle->{},
        Evaluator->Automatic,
        Method->"Preemptive"],
       RGBColor[1, 0, 0],
       Editable->False,
       Selectable->False], "]"}], ",", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"120", ",", "20"}], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6537981048981733`*^9, 3.653798134587762*^9}, 
   3.65379816638286*^9, 3.653798213951426*^9, 3.653976750460927*^9, 
   3.6543217598553658`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"x", "[", 
    RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "//", "Graphics"}]], "Input",
 CellChangeTimes->{{3.653798167755735*^9, 3.65379822258925*^9}}],

Cell[BoxData[
 GraphicsBox[GeometricTransformationBox[
   {EdgeForm[GrayLevel[0]], FaceForm[RGBColor[1, 0, 0]], 
    LineBox[{{-10, 10}, {130, 10}}], 
    {EdgeForm[RGBColor[1, 0, 0]], RectangleBox[{0, 0}, {120, 20}]}}, {{{1, 
    0}, {0, 1}}, {0, 0}}]]], "Output",
 CellChangeTimes->{{3.653798168234303*^9, 3.653798223021051*^9}, 
   3.6539767504969873`*^9, 3.654321759893272*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.6537976418177443`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"do", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f", ",", 
     RowBox[{"draw", "[", "c", "]"}]}], "}"}], ",", "Identity", ",", 
   RowBox[{"{", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.653797402540443*^9, 3.6537974314807177`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Identity", "[", 
     RowBox[{"f", "[", "#1", "]"}], "]"}], "&"}], ",", "c", ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6537974359212914`*^9, 3.6537974623534727`*^9}, 
   3.6537977353945227`*^9, 3.653798229182622*^9, 3.653976750530712*^9, 
   3.65432175993146*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.653793625505774*^9, 3.653793630401849*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"do", "[", "ops_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"currentTransform", "=", "Identity"}], ",", "transform", ",", 
      " ", 
      RowBox[{"acc", "=", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"rest", "=", "ops"}], ",", " ", "op", ",", "t"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "rest", "]"}], "\[NotEqual]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"transform", ",", " ", "op", ",", "rest"}], "}"}], "=", 
         RowBox[{"do", "[", 
          RowBox[{"rest", ",", "currentTransform", ",", "rest"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"acc", ",", 
          RowBox[{"transform", "[", "op", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"currentTransform", "=", "transform"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "acc"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.653794480348032*^9, 3.653794598675271*^9}, {
  3.65379464157411*^9, 3.653794770054407*^9}, {3.653795299750606*^9, 
  3.6537953431906652`*^9}, {3.65379541457232*^9, 3.6537955161999826`*^9}, {
  3.6537971117657824`*^9, 3.653797120112564*^9}, {3.6537977636304493`*^9, 
  3.6537977929037657`*^9}, {3.653797834766418*^9, 3.6537978500667458`*^9}, {
  3.653798280309598*^9, 3.653798388694964*^9}, {3.653798547631113*^9, 
  3.65379860562716*^9}, {3.653798691165126*^9, 3.6537987220584917`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"do", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"flip", "[", "]"}], ",", 
     RowBox[{"rotate", "[", 
      RowBox[{"30", " ", "Degree"}], "]"}], ",", 
     RowBox[{"draw", "[", "wagon", "]"}]}], "}"}], "]"}], "//", 
  "Graphics"}]], "Input",
 CellChangeTimes->{{3.653798245438286*^9, 3.653798254577757*^9}, {
  3.653798394297573*^9, 3.653798396243997*^9}, {3.653798576837776*^9, 
  3.65379857813067*^9}, {3.6543331162485857`*^9, 3.654333133381341*^9}}],

Cell[BoxData[
 GraphicsBox[GeometricTransformationBox[GeometricTransformationBox[
    {EdgeForm[GrayLevel[0]], FaceForm[RGBColor[1, 0, 0]], 
     LineBox[{{-10, 10}, {130, 10}}], 
     {EdgeForm[RGBColor[1, 0, 0]], RectangleBox[{0, 0}, {120, 20}]}}, {{{
     0.8660254037844386, 0.5}, {-0.5, 0.8660254037844386}}, {0, 0}}], {{{1, 
    0}, {0, -1}}, Center}]]], "Output",
 CellChangeTimes->{{3.6537982554348516`*^9, 3.6537983973616447`*^9}, {
   3.65379855447963*^9, 3.653798578484602*^9}, 3.653798613778429*^9, 
   3.653798723819406*^9, 3.653798837839384*^9, 3.65397675057178*^9, 
   3.654321759997854*^9, {3.654333120494562*^9, 3.654333134246419*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t0", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FaceForm", "[", "White", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"600", ",", 
           RowBox[{"-", "400"}]}], "}"}]}], "]"}], ",", "Dashed", ",", " ", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"300", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"300", ",", 
            RowBox[{"-", "400"}]}], "}"}]}], "}"}], "]"}], ",", "  ", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "200"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"600", ",", 
            RowBox[{"-", "200"}]}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}], 
    ",", 
    RowBox[{
     RowBox[{"do", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"flip", "[", "]"}], ",", 
        RowBox[{"draw", "[", "wagon", "]"}]}], "}"}], "]"}], "//", 
     "Graphics"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6537953511046658`*^9, 3.653795400666389*^9}, {
  3.653795525873273*^9, 3.653795531543298*^9}, {3.653795564620059*^9, 
  3.653795565238673*^9}, {3.6537956041546783`*^9, 3.653795607551524*^9}, {
  3.6537971348626137`*^9, 3.6537971430668592`*^9}, {3.653798618609804*^9, 
  3.653798654240348*^9}, {3.6537987405780888`*^9, 3.653798949644876*^9}, {
  3.654321796299254*^9, 3.654321986320182*^9}, {3.6543220809255447`*^9, 
  3.654322086054846*^9}, {3.654332928882303*^9, 3.65433294283221*^9}, {
  3.6543331448469257`*^9, 3.65433315663643*^9}, {3.654333428932199*^9, 
  3.654333452288015*^9}, {3.654333488065789*^9, 3.6543334896733513`*^9}, {
  3.654333521861496*^9, 3.654333591681715*^9}, {3.654333680880905*^9, 
  3.654333824116869*^9}, {3.654334056135892*^9, 3.654334056326804*^9}, {
  3.654334451388544*^9, 3.654334517090473*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
    RectangleBox[{0, 0}, {600, -400}], 
    {Dashing[{Small, Small}], LineBox[{{300, 0}, {300, -400}}], 
     LineBox[{{0, -200}, {600, -200}}]}}, GeometricTransformationBox[
    {EdgeForm[GrayLevel[0]], FaceForm[RGBColor[1, 0, 0]], 
     LineBox[{{-10, 10}, {130, 10}}], 
     {EdgeForm[RGBColor[1, 0, 0]], RectangleBox[{0, 0}, {120, 20}]}}, {{{1, 
     0}, {0, -1}}, {0, 0}}]}]], "Output",
 CellChangeTimes->{{3.653798821108618*^9, 3.653798877763098*^9}, {
   3.653798910224456*^9, 3.653798951463908*^9}, 3.653976750612076*^9, 
   3.65432176003228*^9, {3.65432181898624*^9, 3.654321986785583*^9}, 
   3.654322083045506*^9, 3.6543222559518538`*^9, {3.654332935997271*^9, 
   3.6543329435351954`*^9}, {3.6543331470253677`*^9, 3.654333158587603*^9}, {
   3.654333432070992*^9, 3.654333490001094*^9}, {3.654333546483437*^9, 
   3.654333592611402*^9}, {3.6543336849436903`*^9, 3.654333712786346*^9}, {
   3.654333761142754*^9, 3.6543338246952763`*^9}, 3.654334056906218*^9, {
   3.6543344634258347`*^9, 3.654334472250238*^9}, {3.654334504571065*^9, 
   3.6543345177582083`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<t0.png\>\"", ",", " ", "t0", ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", "1024", "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.654333364170189*^9, 3.6543333647925463`*^9}, {
  3.654333837099339*^9, 3.6543338830467167`*^9}, {3.654334458801512*^9, 
  3.654334460680233*^9}, {3.654334495850114*^9, 3.654334500900826*^9}}],

Cell[BoxData["\<\"t0.png\"\>"], "Output",
 CellChangeTimes->{{3.654334464550344*^9, 3.654334474080489*^9}, {
  3.654334505894526*^9, 3.654334521643655*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t1", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FaceForm", "[", "White", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"600", ",", 
           RowBox[{"-", "400"}]}], "}"}]}], "]"}], ",", "Dashed", ",", " ", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"300", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"300", ",", 
            RowBox[{"-", "400"}]}], "}"}]}], "}"}], "]"}], ",", "  ", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "200"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"600", ",", 
            RowBox[{"-", "200"}]}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}], 
    ",", 
    RowBox[{
     RowBox[{"do", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"flip", "[", "]"}], ",", 
        RowBox[{"translate", "[", 
         RowBox[{"{", 
          RowBox[{"300", ",", "200"}], "}"}], "]"}], ",", 
        RowBox[{"rotate", "[", 
         RowBox[{"Pi", "/", "6"}], "]"}], ",", 
        RowBox[{"translate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "l"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "w"}], "/", "2"}]}], "}"}], "]"}], ",", 
        RowBox[{"draw", "[", "wagon", "]"}]}], "}"}], "]"}], "//", 
     "Graphics"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6537953511046658`*^9, 3.653795400666389*^9}, {
  3.653795525873273*^9, 3.653795531543298*^9}, {3.653795564620059*^9, 
  3.653795565238673*^9}, {3.6537956041546783`*^9, 3.653795607551524*^9}, {
  3.6537971348626137`*^9, 3.6537971430668592`*^9}, {3.653798618609804*^9, 
  3.653798654240348*^9}, {3.6537987405780888`*^9, 3.653798949644876*^9}, {
  3.654321796299254*^9, 3.654321986320182*^9}, {3.6543220809255447`*^9, 
  3.654322086054846*^9}, {3.654332928882303*^9, 3.65433294283221*^9}, {
  3.6543331448469257`*^9, 3.65433315663643*^9}, {3.654333428932199*^9, 
  3.654333452288015*^9}, {3.654333488065789*^9, 3.6543334896733513`*^9}, {
  3.654333521861496*^9, 3.654333591681715*^9}, {3.654333680880905*^9, 
  3.654333824116869*^9}, {3.654334056135892*^9, 3.654334056326804*^9}, {
  3.654334451388544*^9, 3.654334471796384*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
    RectangleBox[{0, 0}, {600, -400}], 
    {Dashing[{Small, Small}], LineBox[{{300, 0}, {300, -400}}], 
     LineBox[{{0, -200}, {600, -200}}]}}, 
   GeometricTransformationBox[
    GeometricTransformationBox[
     GeometricTransformationBox[GeometricTransformationBox[
       {EdgeForm[GrayLevel[0]], FaceForm[RGBColor[1, 0, 0]], 
        LineBox[{{-10, 10}, {130, 10}}], 
        {EdgeForm[RGBColor[1, 0, 0]], 
         RectangleBox[{0, 0}, {120, 20}]}}, {-60, -10}], {{{
       0.8660254037844386, -0.5}, {0.5, 0.8660254037844386}}, {0, 0}}], {300, 
     200}], {{{1, 0}, {0, -1}}, {0, 0}}]}]], "Output",
 CellChangeTimes->{{3.653798821108618*^9, 3.653798877763098*^9}, {
   3.653798910224456*^9, 3.653798951463908*^9}, 3.653976750612076*^9, 
   3.65432176003228*^9, {3.65432181898624*^9, 3.654321986785583*^9}, 
   3.654322083045506*^9, 3.6543222559518538`*^9, {3.654332935997271*^9, 
   3.6543329435351954`*^9}, {3.6543331470253677`*^9, 3.654333158587603*^9}, {
   3.654333432070992*^9, 3.654333490001094*^9}, {3.654333546483437*^9, 
   3.654333592611402*^9}, {3.6543336849436903`*^9, 3.654333712786346*^9}, {
   3.654333761142754*^9, 3.6543338246952763`*^9}, 3.654334056906218*^9, {
   3.6543344634258347`*^9, 3.654334472250238*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<t1.png\>\"", ",", " ", "t1", ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", "1024", "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.654333364170189*^9, 3.6543333647925463`*^9}, {
  3.654333837099339*^9, 3.6543338830467167`*^9}, {3.654334458801512*^9, 
  3.654334460680233*^9}}],

Cell[BoxData["\<\"t1.png\"\>"], "Output",
 CellChangeTimes->{{3.654334464550344*^9, 3.654334474080489*^9}}]
}, Open  ]],

Cell[BoxData["\"\<t1.png\>\""], "Input",
 CellChangeTimes->{{3.6543344539972353`*^9, 3.654334455572563*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t2", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FaceForm", "[", "White", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"600", ",", 
           RowBox[{"-", "400"}]}], "}"}]}], "]"}], ",", "Dashed", ",", " ", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"300", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"300", ",", 
            RowBox[{"-", "400"}]}], "}"}]}], "}"}], "]"}], ",", "  ", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "200"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"600", ",", 
            RowBox[{"-", "200"}]}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}], 
    ",", 
    RowBox[{
     RowBox[{"do", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"flip", "[", "]"}], ",", 
        RowBox[{"translate", "[", 
         RowBox[{"{", 
          RowBox[{"300", ",", "200"}], "}"}], "]"}], ",", 
        RowBox[{"rotate", "[", 
         RowBox[{"Pi", "/", "6"}], "]"}], ",", 
        RowBox[{"translate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "l"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "w"}], "/", "2"}]}], "}"}], "]"}], ",", 
        RowBox[{"draw", "[", "wagon", "]"}], ",", 
        RowBox[{"translate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"l", "+", 
            RowBox[{"w", "/", "2"}]}], ",", 
           RowBox[{"w", "/", "2"}]}], "}"}], "]"}], ",", 
        RowBox[{"rotate", "[", 
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "4"}], "]"}], ",", 
        RowBox[{"translate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"w", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "w"}], "/", "2"}]}], "}"}], "]"}], ",", 
        RowBox[{"draw", "[", "wagon", "]"}]}], "}"}], "]"}], "//", 
     "Graphics"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6537953511046658`*^9, 3.653795400666389*^9}, {
  3.653795525873273*^9, 3.653795531543298*^9}, {3.653795564620059*^9, 
  3.653795565238673*^9}, {3.6537956041546783`*^9, 3.653795607551524*^9}, {
  3.6537971348626137`*^9, 3.6537971430668592`*^9}, {3.653798618609804*^9, 
  3.653798654240348*^9}, {3.6537987405780888`*^9, 3.653798949644876*^9}, {
  3.654321796299254*^9, 3.654321986320182*^9}, {3.6543220809255447`*^9, 
  3.654322086054846*^9}, {3.654332928882303*^9, 3.65433294283221*^9}, {
  3.6543331448469257`*^9, 3.65433315663643*^9}, {3.654333428932199*^9, 
  3.654333452288015*^9}, {3.654333488065789*^9, 3.6543334896733513`*^9}, {
  3.654333521861496*^9, 3.654333591681715*^9}, {3.654333680880905*^9, 
  3.654333824116869*^9}, {3.654334056135892*^9, 3.654334056326804*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], 
    RectangleBox[{0, 0}, {600, -400}], 
    {Dashing[{Small, Small}], LineBox[{{300, 0}, {300, -400}}], 
     LineBox[{{0, -200}, {600, -200}}]}}, {
    GeometricTransformationBox[
     GeometricTransformationBox[
      GeometricTransformationBox[GeometricTransformationBox[
        {EdgeForm[GrayLevel[0]], FaceForm[RGBColor[1, 0, 0]], 
         LineBox[{{-10, 10}, {130, 10}}], 
         {EdgeForm[RGBColor[1, 0, 0]], 
          RectangleBox[{0, 0}, {120, 20}]}}, {-60, -10}], {{{
        0.8660254037844386, -0.5}, {0.5, 0.8660254037844386}}, {0, 0}}], {300,
       200}], {{{1, 0}, {0, -1}}, {0, 0}}], 
    GeometricTransformationBox[
     GeometricTransformationBox[
      GeometricTransformationBox[
       GeometricTransformationBox[
        GeometricTransformationBox[
         GeometricTransformationBox[GeometricTransformationBox[
           {EdgeForm[GrayLevel[0]], FaceForm[RGBColor[1, 0, 0]], 
            LineBox[{{-10, 10}, {130, 10}}], 
            {EdgeForm[RGBColor[1, 0, 0]], RectangleBox[{0, 0}, {120, 20}]}}, {
           10, -10}], {{{0.7071067811865475, 
           0.7071067811865475}, {-0.7071067811865475, 0.7071067811865475}}, {
           0, 0}}], {130, 10}], {-60, -10}], {{{0.8660254037844386, -0.5}, {
        0.5, 0.8660254037844386}}, {0, 0}}], {300, 200}], {{{1, 0}, {
      0, -1}}, {0, 0}}]}}]], "Output",
 CellChangeTimes->{{3.653798821108618*^9, 3.653798877763098*^9}, {
   3.653798910224456*^9, 3.653798951463908*^9}, 3.653976750612076*^9, 
   3.65432176003228*^9, {3.65432181898624*^9, 3.654321986785583*^9}, 
   3.654322083045506*^9, 3.6543222559518538`*^9, {3.654332935997271*^9, 
   3.6543329435351954`*^9}, {3.6543331470253677`*^9, 3.654333158587603*^9}, {
   3.654333432070992*^9, 3.654333490001094*^9}, {3.654333546483437*^9, 
   3.654333592611402*^9}, {3.6543336849436903`*^9, 3.654333712786346*^9}, {
   3.654333761142754*^9, 3.6543338246952763`*^9}, 3.654334056906218*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<t2.png\>\"", ",", " ", "t2", ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", "1024", "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.654333364170189*^9, 3.6543333647925463`*^9}, {
  3.654333837099339*^9, 3.6543338830467167`*^9}}],

Cell[BoxData["\<\"t2.png\"\>"], "Output",
 CellChangeTimes->{3.6543338839902487`*^9, 3.654333953057479*^9, 
  3.6543340581643667`*^9}]
}, Open  ]],

Cell[BoxData["set"], "Input",
 CellChangeTimes->{{3.654333917180936*^9, 3.654333917427884*^9}}]
},
WindowSize->{1738, 1114},
WindowMargins->{{Automatic, -1833}, {116, Automatic}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 29, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 172, 3, 28, "Input"],
Cell[755, 27, 151, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[943, 34, 406, 7, 97, "Input"],
Cell[1352, 43, 218, 4, 28, "Output"],
Cell[1573, 49, 217, 4, 28, "Output"],
Cell[1793, 55, 218, 4, 28, "Output"],
Cell[2014, 61, 218, 4, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2269, 70, 2545, 69, 28, "Input"],
Cell[4817, 141, 5266, 143, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10120, 289, 951, 24, 97, "Input"],
Cell[11074, 315, 813, 14, 198, "Output"]
}, Open  ]],
Cell[11902, 332, 141, 2, 28, "Input"],
Cell[12046, 336, 92, 1, 28, "Input"],
Cell[12141, 339, 127, 2, 28, "Input"],
Cell[12271, 343, 255, 7, 28, "Input"],
Cell[12529, 352, 374, 9, 28, "Input"],
Cell[12906, 363, 306, 9, 46, "Input"],
Cell[13215, 374, 408, 12, 28, "Input"],
Cell[13626, 388, 2155, 47, 148, "Input"],
Cell[CellGroupData[{
Cell[15806, 439, 1027, 19, 28, "Input"],
Cell[16836, 460, 5784, 157, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22657, 622, 263, 7, 28, "Input"],
Cell[22923, 631, 381, 7, 79, "Output"]
}, Open  ]],
Cell[23319, 641, 70, 1, 28, "Input"],
Cell[CellGroupData[{
Cell[23414, 646, 265, 7, 28, "Input"],
Cell[23682, 655, 357, 9, 28, "Output"]
}, Open  ]],
Cell[24054, 667, 92, 1, 28, "Input"],
Cell[24149, 670, 1755, 40, 182, "Input"],
Cell[CellGroupData[{
Cell[25929, 714, 495, 12, 28, "Input"],
Cell[26427, 728, 652, 10, 250, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27116, 743, 2153, 52, 28, "Input"],
Cell[29272, 797, 1157, 19, 256, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30466, 821, 396, 7, 28, "Input"],
Cell[30865, 830, 156, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31058, 837, 2583, 64, 46, "Input"],
Cell[33644, 903, 1322, 23, 260, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35003, 931, 350, 7, 28, "Input"],
Cell[35356, 940, 107, 1, 28, "Output"]
}, Open  ]],
Cell[35478, 944, 108, 1, 28, InheritFromParent],
Cell[CellGroupData[{
Cell[35611, 949, 3106, 79, 46, "Input"],
Cell[38720, 1030, 2003, 36, 260, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40760, 1071, 301, 6, 28, "Input"],
Cell[41064, 1079, 134, 2, 28, "Output"]
}, Open  ]],
Cell[41213, 1084, 95, 1, 28, "Input"]
}
]
*)

(* End of internal cache information *)
